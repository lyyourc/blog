---
title: è¿™ä¹ˆå¯çˆ±çš„ emoji è¡¨æƒ…ï¼Œè°é¡¶å¾—ä½å•Š ğŸ˜›
date: "2019-01-01"
draft: false
---

æˆ‘ä»¬çš„ç›®æ ‡ï¼š**æŠŠ emoji è¡¨æƒ…æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š**ã€‚

## å‚è€ƒç°æœ‰çš„æ–¹æ¡ˆ

æœç´¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº† [emoji-mart](https://github.com/missive/emoji-mart) è¿™ä¸ªç»„ä»¶ã€‚
ç®€å•åœ°çœ‹ä¸‹æºç å¯çŸ¥ï¼Œemoji çš„æ•°æ®éƒ½æ¥è‡ªäº [emoji-data](https://github.com/iamcal/emoji-data) è¿™ä¸ªåŒ…ã€‚

`emoji-data` é‡Œé¢æœ‰ä¸ªå­—æ®µ `unified`ï¼Œä»–è¡¨ç¤º unicode çš„ä¸€ä¸ª codepoint ï¼Œé€šå¸¸æ˜¯ 4-5 ä¸ªæ•°å­—ã€‚
å¦‚æœè¿™ä¸ª emoji è¡¨æƒ…æ˜¯ç”¨å¤šä¸ªè¡¨æƒ…ç»„æˆèµ·æ¥çš„ï¼Œåˆ™ç”¨ `-` æŠŠè¡¨æƒ…è¿æ¥èµ·æ¥ã€‚

è€Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼ŒæŠŠ [unicode codepoint è½¬æˆåŸç”Ÿï¼ˆ native ï¼‰çš„å­—ç¬¦](https://github.com/missive/emoji-mart/blob/master/src/utils/index.js#L9)ã€‚

```js
function unifiedToNative(unified: string) {
  const unicodes = unified.split('-')
  const codePoints = unicodes.map(u => `0x${u}`)

  return String.fromCodePoint(...codePoints)
}

unifiedToNative('1f600') // 'ğŸ˜€'
```

å› ä¸ºä¸åŒçš„å­—ç¬¦åœ¨ä¸åŒçš„å¹³å°ä¸Šä¼šæœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥æƒ³è¦åšåˆ°å…¨å…¼å®¹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å›¾ç‰‡ã€‚

## Emoji Sprite

ç°æœ‰çš„ emoji åŠ èµ·æ¥å¯èƒ½æœ‰ä¸€åƒå¤šä¸ªï¼Œä¸ºäº†åŠ è½½é€Ÿåº¦ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æŠŠæ‰€æœ‰çš„ emoji è¡¨æƒ…å•ç‹¬éƒ½åšæˆä¸€ä¸ªå›¾ç‰‡ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ [image sprites](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Images/Implementing_image_sprites_in_CSS) ã€‚

åœ¨ [emoji-data](https://github.com/iamcal/emoji-data) ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸åŒå¹³å°å¯¹åº”çš„ç²¾çµå›¾ï¼Œæ¯”å¦‚ [Apple ç³»åˆ—çš„ 64px](https://github.com/iamcal/emoji-data/blob/master/sheets-indexed-256/sheet_apple_64_indexed_256.png)ã€‚
å¦å¤–ï¼Œé€šè¿‡ `sheet_x` å’Œ `sheet_y` å¯ä»¥å¾—åˆ°æ¯ä¸ªè¡¨æƒ…çš„åæ ‡ã€‚æœ€åæˆ‘ä»¬ç®—å‡ºå¯¹åº”çš„ä½ç½®ï¼Œè®¾ç½® `background-position` ã€‚

```js
const spriteWidth = 3432 // åŸå›¾çš„å¤§å°
const spriteHeight = 3432
const rows = 52
const cols = 52

// å‡è®¾æŸä¸ª emoji çš„åæ ‡
const emoji = { sheet_x: 2, sheet_y: 20 }

// è®¡ç®—ä½ç½®
css`
  background-position: ${sheet_x * (spriteWidth / cols)}, ${sheet_y * (spriteHeight / rows)}
  background-size: 64px 64px;
`
```

å¯ä»¥å‚è€ƒå…¶ä»–ç®—æ³•ï¼Œå¦‚ [emoji-mart](https://github.com/missive/emoji-mart/blob/master/src/components/emoji/nimble-emoji.js#L165-L167) ã€‚